图像处理17:3A算法
1.3A算法概述：

       3A技术即自动对焦（AF）、自动曝光（AE）和自动白平衡（AWB），3A数字成像技术利用了AF、AE、AWB算法实现图像对比度最大、改善目标拍摄物过曝光或曝光不足情况，使画面在不同光线照射下的色差得到补偿，从而呈现较高画质的图像信息。

       利用3A技术的摄像机能够很好的保障图像精准的色彩还原度，呈现完美的日夜间监控效果。

 

2.AF（自动对焦算法）：

   自动对焦技术通过调整聚焦镜头的位置获得最高的图像频率成分，从而得到更高的对比度。

         （1）自动对焦算法概述：

                   自动对焦技术获得最佳对焦点是一个不断积累的过程，通过比较每一帧图像的对比度从而获得镜头移动范围内最大的对比度点，从而获得对焦距离。

                   目前的自当对焦系统流行采用“爬山算法”，该算法的局限性在于它只适应图像本身色差较大的情况。

         （2）自动对焦算法的实现：

                    自动对焦算法的基本步骤是先判断图像的模糊程度，通过合适的模糊度评价函数求得采集的每一副图像的评价值, 然后通过搜索算法得到一系列评价值的峰值, 最后通过电机驱动将采集设备调节到峰值所在的位置, 得到最清晰的图像, 算法的关键在于达到准确度和速度的平衡, 同时算法的精度受到软件算法和硬件精度的双重影响。

                   对焦评价函数有很多种, 主要考虑的图像因素有图像频率(清晰的图像纹理多, 高频分布较多), 还有图像的灰度分量的分布(图像对应的灰度图的分量分布范围越大,说明图像的细节较多, 反应图像的清晰程度越高)。

                  常用的搜索算法有爬山算法, 搜索窗口有黄金分割点对焦嵌套窗口等。

 

3.AE（自动曝光算法）：

  自动曝光算法控制自动调节图像的亮度。

         （1）自动曝光算法概述：

                   自动曝光算法根据可用的光源条件自动设置曝光值，当目标和背景的亮度相差很大时，一般会造成目标的过曝光或曝光不足，为克服这个问题，一些特定的自动曝光算法着重考虑目标拍摄物的亮度情况，在进行亮度调节时给予这部分更多的比重。

         （2）自动曝光算法的实现：

                   一般的自动曝光算法通过获取图像的亮度调节相应的曝光参数，得到合适的曝光量。曝光参数包括光圈大小, 快门速度和摄像头传感器的亮度增益。

                   获取图像亮度,可采用的方法有：1.平均亮度 ；2.分区加权平均亮度 ，分区域加权的目的在于将曝光重点放在屏幕中央 ；3.设置不同亮度门限, 对背光, 正光和强光区域进行区分；4.对主要对象进行曝光补偿。

                   调整参数的主要方法有：1.查表法 ，系统内部预先存储了一张曝光参数调整的步长与图像亮度之间的关系的查找表, 通过亮度值改变调整量；2.迭代法 ；3.数值计算法。

 

3.AWB（自动白平衡算法）：

  自动白平衡对不同光线造成的色差给予补偿。

         （1）白平衡概述：

                   白平衡英文名称为White Balance，物体颜色会因投射光白平衡设置线颜色产生改变，在不同光线的场合下拍摄出的照片会有不同的色温，例如以钨丝灯(电灯泡)照明的环境拍出的照片可能偏黄；图片采用自然光，强加白平衡后，图像偏蓝；若在灯光底下用白平衡，图片的色调就会恢复到原色状态。

                  白平衡会按目前画像中图像特质，立即调整整个图像红绿蓝三色的强度，以修正外部光线所造成的误差。平衡就是无论环境光线如何，让摄相机识别出白色，而平衡其他颜色在有色光线下的色调。颜色实质上就是对光线的解释，对于这一切如果能调整白平衡，则在所得到的照片中就能正确地以"白"为基色来还原其他颜色。

                  白平衡与周围光线密切相关，因而启动白平衡功能时闪光灯的使用就要受到限制，否则环境光的变化会使得白平衡失效或干扰正常的白平衡。

         （2）自动白平衡算法概述：

                   自动白平衡算法用来修正引起色温变化而出现的色彩失真现象，使用自动白平衡算法的摄像机不仅在低光照环境下拍摄更好的图像，也能够提供更好的色彩还原度和偏色补偿功能。

         （3）自动白平衡算法的实现：

                   一般的自动白平衡算法根据环境光源的色温调节白平衡增益,使拍摄画面的颜色接近物体真实的颜色。

                   估算环境光色温, 经典算法包括:1.灰度世界假设算法 ，对于一幅含有大量色彩的图片, 其颜色分量的均值R、G、B趋向于同一灰度K, 基于该假设的算法在图像色彩分布均匀时, 效果理想; 分布不均时, 效果失常；2.白块假设算法 ，认为图像中最亮的点是白色点。一些算法提取图像中的颜色特征, 直接转换到色温坐标下进行色温估计, 实际图像中的色温基本是混合色温, 在实际应用中的这种算法实现不多。
                   计算和调节增益最简单的方式是通过求取图像的平均颜色分量对应的增益，然后,对整副图的RGB分量进行调整。
